\documentclass[fleqn]{llncs}
\usepackage{latexsym}
\usepackage{amssymb,amsmath}
\usepackage{stmaryrd}
\usepackage{graphicx}
%\usepackage{color}
\usepackage{hyperref}
\usepackage{phonetic}
\usepackage{xargs}
\usepackage[pdftex,dvipsnames]{xcolor}
\usepackage{listings}

\lstset{language=haskell,basicstyle=\ttfamily\small,breaklines=true,showspaces=false,
  showstringspaces=false,breakatwhitespace=true,texcl=true}

\input{towards-spec-sym-comp-def}

\usepackage[colorinlistoftodos,textsize=tiny]{todonotes}
\newcommandx{\unsure}[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
\newcommandx{\change}[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
\newcommandx{\info}[2][1=]{\todo[linecolor=OliveGreen,backgroundcolor=OliveGreen!25,bordercolor=OliveGreen,#1]{#2}}
\newcommandx{\improvement}[2][1=]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum,#1]{#2}}

\title{Towards Specifying Symbolic Computation\thanks{This research is
    supported by NSERC.}}

\author{Jacques Carette and William M. Farmer}

\institute{%
Computing and Software, McMaster University, Canada\\
\url{http://www.cas.mcmaster.ca/~carette}\\
\url{http://imps.mcmaster.ca/wmfarmer}\\[1.5ex]
%21 Feburary 2019
}

\pagestyle{headings}

\iffalse

Examples:

  1. Factoring integers
  2. Change of representation for polynomials
  3. Normalization of rational expressions
  4. Integration by parts
  5. Symbolic differentiation
      o ln/exp example

Example format:

  1. Mathematical task
  2. How the task is performed in Maple
  3. Problems with performing the task
  4. Proposed solution
  5. Specification of the task in CTT_uqe

\fi

\begin{document}

\maketitle

\begin{abstract}
??
\end{abstract}

\iffalse 

\textbf{Keywords:} ??

\fi

\section{Introduction}

\section{Simplifying Expressions denoting Rational Functions}

\subsection{The Problem}

Let $f = \LambdaApp x : \mathbb{Q} \mdot R(x)$ be an expression that
denotes a function of type $\mathbb{Q} \tarrow \mathbb{Q}$.
Furthermore, let $R(x)$, as a syntactic expression, denote a member of
the field $\mathbb{Q}(x)$ consisting of \emph{rational expressions} of
the form $\frac{P(x)}{Q(x)}$ where $P(x)$ and $Q(x)$ are polynomials
in $x$.  A function that can be represented by an expression like $f$
whose body is a rational expression is called a \emph{rational
  function}.

$R(x)$ could be a very complicated expression build from the primitive
components of the field $\mathbb{Q}(x)$: $0,1,+,*,-,\phantom{}^{-1}$.
An obvious way to simplify $f$ would be to simplify $R(x)$
syntactically as a rational expression in a meaning-preserving way.
This operation, which we will call \mname{simpRatFun}, is an example
of a \emph{syntax-based mathematical algorithm (SBMA)}.  As an SBMA,
\mname{simpRatFun} works by manipulating syntactic expressions in a
mathematically meaningful way.

SBMAs can be difficult to specify since they involve an interplay of
syntax and semantics.  We are interested in the following three
questions:

\be

  \item What should be the specification of \mname{simpRatFun}?

  \item Can this specification be expressed in traditional logic?

  \item How would this specification be expressed in a logic with
    undefinedness, quotation, and evaluation?

\ee

\subsection{A Naive Specification}

Let $R(x)$ be an expression that denotes a member of $\mathbb{Q}(x)$.
The \emph{normal form} of $R(x)$ is an expression $R'(x)$ of the form
$\frac{P(x)}{Q(x)}$ such that $P(x)$ and $Q(x)$ are polynomials in
standard form, $\frac{P(x)}{Q(x)}$ is in lowest terms, and $R(x)$ and
$R'(x)$ both denote the same member of $\mathbb{Q}(x)$.  For example,
the normal form of \[\frac{x^2 + 2x - 1}{x^2 - 1} - \frac{x}{x - 1}\]
is \[\frac{1}{x + 1}.\]

If we do not think too hard, we might be tempted to specify
\mname{simpRatFun} as follows: 

\bi

  \item[] For all expressions $f = \LambdaApp x : \mathbb{Q} \mdot
    R(x)$ of type $\mathbb{Q} \tarrow \mathbb{Q}$ where the expression
    $R(x)$ denotes a member of $\mathbb{Q}(x)$, $\mname{simpRatFun}(f)
    = \LambdaApp x : \mathbb{Q} \mdot R'(x)$ where $R'(x)$ is the
    normal form of $R(x)$.

\ei
%
Hence \mname{simpRatFun} applied to \[\LambdaApp x : \mathbb{Q} \mdot
\frac{x^2 + 2x - 1}{x^2 - 1} - \frac{x}{x - 1}\] should return 
\[\LambdaApp x : \mathbb{Q} \mdot \frac{1}{x + 1}.\]

This specification is essentially the same as Maple's \mname{normal}
operation that reduces the expression $\frac{x^2 - 2x - 1}{x^2 - 1} -
\frac{x}{x - 1}$ to $\frac{1}{x + 1}$.

Is this specification of \mname{simpRatFun} correct?  If so, $f$ and
$\mname{simpRatFun}(f)$ should denote the same function of type
$\mathbb{Q} \tarrow \mathbb{Q}$ for all expressions $f$ that denote
rational functions.  Unfortunately, this is not the case.  Let \[f =
\LambdaApp x : \mathbb{Q} \mdot \frac{x^2 + 2x - 1}{x^2 - 1} -
\frac{x}{x - 1}.\]  Then $f(1)$ is obviously undefined, but
$\mname{simpRatFun}(f)(1) = 1/2$.  Hence \mname{simpRatFun} is --- as
specified --- not meaning preserving.  What went wrong?

\subsection{A Correct Specification}

\subsection{A Formalized Specification}

\newcommand{\QQ}{\ensuremath{\mathbb{Q}}}
\newcommand{\NRE}{\ensuremath{\mname{normRatExpr}}}
\newcommand{\funQ}[1]{\ensuremath{\LambdaApp x : \QQ \mdot#1}}
\newcommand{\Lang}{\ensuremath{\mathcal{L}}}

\section{Rational Expressions, Rational Functions}

\subsection{The Problem}

Let $e$ be an expression in the language $\Lang$ of the field
$\QQ(x)$, that is, a well-formed expression built from the symbols $x,
0, 1, +, *, -, \phantom{}^{-1}$, elements of $\QQ$ and parentheses (as
necessary).  For greater readability, we will take the liberty of
using fractional notation for $\phantom{}^{-1}$ and the exponential
notation $x^n$ for $x * \cdots * x$ ($n$ times).  $e$ can be something
simple like $\frac{x^4-1}{x^2-1}$ or something more complicated like
\begin{equation*}
\frac{\frac{1-x}{3/2 x^{18} + x + 17}}
     {\frac{1}{9834*x^{19393874}-1/5}}+3*x -\frac{12}{x}.
\end{equation*}
The meaning of $e$, written $\sembrack{e}_{\mathbb{Q}(x)}$, is the
element of $\QQ(x)$ that $e$ denotes.  If $e$ is an expression like
$x/0$, then the meaning of $e$ is undefined and $e$ is said to be
\emph{undefined}.  We will call members of $\Lang$ \emph{rational
  expressions}.  Two rational expressions $e$ and $e'$ are
\emph{equal}, written $e = e'$, if they are both defined and
$\sembrack{e}_{\mathbb{Q}(x)} = \sembrack{e'}_{\mathbb{Q}(x)}$ and are
\emph{quasi-equal}, written $e \simeq e'$, if either $e = e'$ or they
are both undefined.

We are taught that, like for members of $\QQ$ (such as $5/15$), there
is a \emph{normal form} for rational expressions. This is typically
defined to be an expression $p/q$ for two polynomials $p,q \in
\QQ\left[x\right] \subseteq \QQ(x)$ such that $p$ and $q$ are
themselves in polynomial normal form and $\mname{gcd}\left(p,q\right)
= 1$.  The motivation for the latter property is that we usually want
to write $\frac{x^4-1}{x^2-1}$ as $x^2 + 1$ just as we usually want to
write $5/15$ as $1/3$.  Thus, the normal forms of
$\frac{x^4-1}{x^2-1}$ and $\frac{x}{x}$ are $x^2 + 1$ and $1$,
respectively.  This definition of normal form is based on the
characteristic that the elements of the \emph{field of fractions} of a
ring $R$ can be written as quotients $r/s$ of elements of $R$ where
$r_0/s_0 = r_1/s_1$ if and only if $r_0 * s_1 = r_1 * s_0$ in $R$.

Every computer algebra system implements a function that
\emph{normalizes} rational expressions that denote elements of $\QQ$,
$\QQ[x]$, and $\QQ(x)$.  Let {\NRE} be the name of an algorithm that
implements this function.  It should certainly have the signature
$\NRE : \Lang \rightarrow \Lang$ and satisfy the invariant $\NRE(e)
\simeq e$ --- in other words, be \emph{meaning preserving} --- for all
$e \in \Lang$.  {\NRE} is an example of an SBMA.  Note that merely
giving the signature of {\NRE} and saying that it is meaning
preserving is a (tremendously) incomplete specification of the
\emph{computational behavior} of {\NRE}.

\info{SBMA should be defined in the Introduction.}
\iffalse
SBMAs can be difficult to specify since they involve an interplay of
syntax and semantics.  We have to be careful of \emph{which} semantics
is used to guide the syntactic manipulations, as different semantics
for the \textbf{same} expression can be inconsistent.
\fi

A rational expression $e$ can be interpreted as a \emph{function} $f =
\LambdaApp x : \QQ \mdot e$.  Such functions are typically called
\emph{rational functions}.  One might think that the rational
functions $\funQ{x/x}$ and $\funQ{1}$ should be equal since $x/x$ and
$1$ are equal as rational expressions.  But they are not equal since
$\funQ{x/x}$ is undefined at 0, while $\funQ{1}$ is defined
everywhere.  Hence, if a rational expression $e$ is interpreted as a
function, then it is not valid to simplify the function by applying
{\NRE} to $e$, but CASs let the user do exactly this because usually
there is no distinction made between $e$ as a rational expression and
$e$ as representing a rational function.  We need to know the
\emph{mathematical meaning} of {\NRE} applied to rational functions to
be able to avoid unsound applications of {\NRE}.

\unsure{I don't know why we need to say this: Of course, given some
  symbol $y$, $f(y)$ \textbf{is} in $\Lang$.}

We are thus interested in the following questions:

\be

  \item What should the specification of the computational behavior of
    {\NRE} be?

  \item What is the mathematical meaning of {\NRE} be when {\NRE} is
    applied to the body of a rational function?

  \item What features of a logic are needed to express
    {\NRE}'s specification and mathematical meaning?

  \item What features of a logic would make expressing {\NRE}'s
    specification and mathematical meaning relatively straightforward?

\ee

\subsection{The Specification of {\NRE}}

\subsection{The Mathematical Meaning of {\NRE}}

\section{Conclusion}

\bibliography{imps}
\bibliographystyle{splncs04}

\setcounter{tocdepth}{1}
\listoftodos
\setcounter{tocdepth}{0}

\end{document}
